"0","# Divide prices relative to regional average price into multiple groups"
"0","tb.analysis1 <- tb.clean %>%"
"0","  mutate(price_ratio = price / region_average_price)"
"0",""
"0","# Calculate the mean and standard deviation of the price ratio"
"0","price_mean <- mean(tb.analysis1$price_ratio, na.rm = TRUE)"
"0","price_sd <- sd(tb.analysis1$price_ratio, na.rm = TRUE)"
"0",""
"0","# Divide prices relative to regional average price into three groups"
"0","tb.analysis1 <- tb.analysis1 %>%"
"0","  mutate(price_group = case_when("
"0","    price_ratio <= (price_mean - price_sd) ~ ""below_avg"","
"0","    price_ratio > (price_mean - price_sd) & price_ratio <= price_mean ~ ""avg_minus"","
"0","    price_ratio > price_mean & price_ratio <= (price_mean + price_sd) ~ ""avg_plus"","
"0","    price_ratio > (price_mean + price_sd) ~ ""above_avg"""
"0","  ))"
"0"," "
"0","# Calculate mean and standard deviation"
"0","scores.avg <- tb.analysis1 %>%"
"0","  group_by(price_group) %>%"
"0","  summarise(average = mean(review_scores_rating, na.rm = TRUE),"
"0","            SD = sd(review_scores_rating, na.rm = TRUE))"
"0",""
"0","#print(scores.avg)"
"0",""
